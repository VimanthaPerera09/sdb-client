{"ast":null,"code":"import React,{useState,useEffect}from'react';import axios from'axios';import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";const crypto=require('crypto');const Search=_ref=>{let{token}=_ref;const[searchTerm,setSearchTerm]=useState('');const[searchResult,setSearchResult]=useState([]);const[userRole,setUserRole]=useState('');const fetchData=async()=>{try{const response=await axios.get(\"http://localhost:3001/search?term=\".concat(searchTerm),{headers:{Authorization:token}});setSearchResult(response.data);}catch(error){console.error('Search failed',error);}};const handleSearch=()=>{// Trigger search when the button is clicked\nfetchData();};useEffect(()=>{const tokenPayload=token.split('.')[1];const decodedPayload=JSON.parse(atob(tokenPayload));const role=decodedPayload.role;setUserRole(role);},[token]);const displayCustomerDetails=customer=>{return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"Name: \",customer.name]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Email: \",customer.email]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Address: \",customer.address]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Phone: \",customer.phone]}),userRole==='admin'?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"Credit Card: \",customer.creditCard]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Medical Records: \",customer.medicalRecords]})]}):userRole==='privileged'?/*#__PURE__*/_jsxs(\"p\",{children:[\"Credit Card: \",customer.creditCard]}):// For normal users\nnull,/*#__PURE__*/_jsx(\"hr\",{})]},customer.id);};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Search\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Enter search term...\",value:searchTerm,onChange:e=>setSearchTerm(e.target.value)}),/*#__PURE__*/_jsx(\"button\",{onClick:handleSearch,children:\"Search\"}),searchResult.map(customer=>displayCustomerDetails(customer))]});};export default Search;","map":{"version":3,"names":["React","useState","useEffect","axios","jsxs","_jsxs","Fragment","_Fragment","jsx","_jsx","crypto","require","Search","_ref","token","searchTerm","setSearchTerm","searchResult","setSearchResult","userRole","setUserRole","fetchData","response","get","concat","headers","Authorization","data","error","console","handleSearch","tokenPayload","split","decodedPayload","JSON","parse","atob","role","displayCustomerDetails","customer","children","name","email","address","phone","creditCard","medicalRecords","id","type","placeholder","value","onChange","e","target","onClick","map"],"sources":["C:/Users/USER/sdp-app/client/src/Search.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\nconst crypto = require('crypto');\r\n\r\n\r\nconst Search = ({ token }) => {\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [searchResult, setSearchResult] = useState([]);\r\n  const [userRole, setUserRole] = useState('');\r\n\r\n  const fetchData = async () => {\r\n    try {\r\n      const response = await axios.get(`http://localhost:3001/search?term=${searchTerm}`, {\r\n        headers: {\r\n          Authorization: token,\r\n        },\r\n      });\r\n\r\n      setSearchResult(response.data);\r\n    } catch (error) {\r\n      console.error('Search failed', error);\r\n    }\r\n  };\r\n\r\n  const handleSearch = () => {\r\n    // Trigger search when the button is clicked\r\n    fetchData();\r\n  };\r\n\r\n  useEffect(() => {\r\n    const tokenPayload = token.split('.')[1];\r\n    const decodedPayload = JSON.parse(atob(tokenPayload));\r\n    const role = decodedPayload.role;\r\n    setUserRole(role);\r\n  }, [token]);\r\n\r\n  const displayCustomerDetails = (customer) => {\r\n    return (\r\n      <div key={customer.id}>\r\n        <p>Name: {customer.name}</p>\r\n        <p>Email: {customer.email}</p>\r\n        <p>Address: {customer.address}</p>\r\n        <p>Phone: {customer.phone}</p>\r\n        {userRole === 'admin' ? (\r\n          <>\r\n            <p>Credit Card: {customer.creditCard}</p>\r\n            <p>Medical Records: {customer.medicalRecords}</p>\r\n          </>\r\n        ) : userRole === 'privileged' ? (\r\n          <p>Credit Card: {customer.creditCard}</p>\r\n        ) : (\r\n          // For normal users\r\n          null\r\n        )}\r\n        <hr />\r\n      </div>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <h2>Search</h2>\r\n      <input\r\n        type=\"text\"\r\n        placeholder=\"Enter search term...\"\r\n        value={searchTerm}\r\n        onChange={(e) => setSearchTerm(e.target.value)}\r\n      />\r\n      <button onClick={handleSearch}>Search</button>\r\n      {searchResult.map((customer) => displayCustomerDetails(customer))}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Search;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}